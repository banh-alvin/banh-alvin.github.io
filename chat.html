<div class="app-container">
  <div class="main-content">
    <div class="chat-container">
      <h2>chat {{ chatId }}</h2>
      
      <div v-if="loading" class="loading-indicator">
        loading messages...
      </div>
      
      <graffiti-discover 
        autopoll
        :channels="['designftw-2025-studio2', `pigeon-chat-${chatId}`]" 
        :where="msg => msg.value && msg.value.chatId === chatId"
        :order-by="item => item.value.id"
        @data="handleGraffitiMessages">
        
        <div class="messages-container" ref="messagesContainer">
          <div v-if="messages.length === 0" class="empty-chat">
            <p>no messages yet</p>
          </div>
          
          <div v-else class="message-list">
            <div v-for="(message, index) in messages" :key="message.id" class="message" :class="{ 'my-message': message.sender === userName }">
              <div class="message-header">
                <span class="message-sender">{{ message.sender }}</span>
                <span class="message-time">{{ message.timestamp }}</span>
                <button @click="deleteMessage(index)" class="delete-message-btn">Ã—</button>
              </div>
              <div class="message-text">{{ message.text }}</div>
            </div>
          </div>
        </div>
      </graffiti-discover>
      
      <div class="message-input">
        <input 
          type="text" 
          v-model="newMessage" 
          @keyup.enter="sendMessage"
          placeholder="type your message..."
        >
        <button @click="sendMessage">ğŸ“¨</button>
      </div>
    </div>
  </div>
  
  <div class="sidebar">
    <todo></todo>
  </div>
</div>